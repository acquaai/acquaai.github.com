<!DOCTYPE html>
<html lang="en">
  <head><meta name="generator" content="Hexo 3.9.0">
    
<!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">

<meta name="theme-color" content="#f8f5ec">
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">















  <link rel="alternate" href="https://acquaai.github.io/atom.xml" title="Acqua">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.6.0">



<link rel="canonical" href="https://acquaai.github.io/page/8/">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.6.0">






  



  <script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>









    <title> Acqua </title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="mobile-header-logo">
    <a href="/." class="logo">Acqua</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/">
        <li class="mobile-menu-item">
          
          
            Home
          
        </li>
      </a>
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            Archives
          
        </li>
      </a>
    
      <a href="/about">
        <li class="mobile-menu-item">
          
          
            About
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Acqua</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              Home
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              Archives
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/about">
            
            
              About
            
          </a>
        </li>
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  <section id="posts" class="posts">
    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2017/12/21/mysql-router/">MySQL Router</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2017-12-21
        </span>
        
          <div class="post-category">
            
              <a href="/categories/MySQL/">MySQL</a>
            
          </div>
        
        
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        
          
        

        
          <blockquote>
<p>MySQL Router是轻量级的中间件，提供数据库访问的Load Balance（负载均衡）、Failover（故障切换）、读写分离等高可用性服务。Router自身的高可用需要借助类Keepalived来实现。</p>
</blockquote>
<p><img src="/images/router_arch.png" alt></p>
          <div class="read-more">
            <a href="/2017/12/21/mysql-router/" class="read-more-link">Read more..</a>
          </div>
        
      
    </div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2017/12/17/mgr-single-m-example/">MGR单主复制配置实例</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2017-12-17
        </span>
        
          <div class="post-category">
            
              <a href="/categories/MySQL/">MySQL</a>
            
          </div>
        
        
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        
          
        

        
          <p><a href="https://acquaai.github.io/2017/12/16/mgr-single-m/">MGR单主复制配置流程</a></p>
<p><strong>Practice</strong></p>
<h2 id="configure-hosts-file-or-dns-for-all-nodes-communication"><a class="markdownIt-Anchor" href="#configure-hosts-file-or-dns-for-all-nodes-communication"></a> Configure hosts file or DNS for all nodes communication</h2>
<h2 id="configure-mysql-configuration-mycnf"><a class="markdownIt-Anchor" href="#configure-mysql-configuration-mycnf"></a> Configure MySQL configuration my.cnf</h2>
<h2 id="gr-initial"><a class="markdownIt-Anchor" href="#gr-initial"></a> GR Initial</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql01:</span><br><span class="line">mysql&gt; install plugin group_replication soname "group_replication.so";</span><br><span class="line">mysql&gt; show plugins;</span><br><span class="line">mysql&gt; set global group_replication_group_name = "a7b884ed-5d97-466a-b676-8ca0466063fd";</span><br><span class="line">mysql&gt; set global group_replication_local_address = "10.0.88.171:24901";</span><br><span class="line"></span><br><span class="line">mysql&gt; set sql_log_bin = 0;</span><br><span class="line">mysql&gt; create user 'rpl_user'@'%' identified by 'rpl_password';</span><br><span class="line">mysql&gt; grant replication slave on *.* to rpl_user@'%' identified by 'rpl_password';</span><br><span class="line">mysql&gt; change master to master_user = 'rpl_user',master_password = 'rpl_password'</span><br><span class="line">	for channel 'group_replication_recovery';</span><br><span class="line">mysql&gt; set sql_log_bin = 1;</span><br><span class="line"></span><br><span class="line">mysql&gt; set global group_replication_bootstrap_group = on;</span><br><span class="line">mysql&gt; start group replication;</span><br><span class="line">mysql&gt; set global group_replication_bootstrap_group = off;</span><br></pre></td></tr></table></figure>
          <div class="read-more">
            <a href="/2017/12/17/mgr-single-m-example/" class="read-more-link">Read more..</a>
          </div>
        
      
    </div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2017/12/16/mgr-single-m/">MGR单主复制配置流程</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2017-12-16
        </span>
        
          <div class="post-category">
            
              <a href="/categories/MySQL/">MySQL</a>
            
          </div>
        
        
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        
          
        

        
          <h2 id="mysql的参数设置"><a class="markdownIt-Anchor" href="#mysql的参数设置"></a> MySQL的参数设置</h2>
<p><code>修改MySQL参数文件---/etc/my.cnf</code></p>
<h3 id="开启binlog和relaylog功能"><a class="markdownIt-Anchor" href="#开启binlog和relaylog功能"></a> 开启Binlog和Relaylog功能</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">server_id = 1</span><br><span class="line">log_bin = binlog</span><br><span class="line">log_slave_updates = ON</span><br><span class="line">relay_log = relay-log</span><br></pre></td></tr></table></figure>
<h3 id="开启gtid功能"><a class="markdownIt-Anchor" href="#开启gtid功能"></a> 开启GTID功能</h3>
<p>Group Replication必须使用GTID功能。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gtid_mode = ON</span><br><span class="line">enforce_gtid_consistency = ON</span><br></pre></td></tr></table></figure>
          <div class="read-more">
            <a href="/2017/12/16/mgr-single-m/" class="read-more-link">Read more..</a>
          </div>
        
      
    </div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2017/12/15/mysql-log-maintenance/">MySQL log maintenance</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2017-12-15
        </span>
        
          <div class="post-category">
            
              <a href="/categories/MySQL/">MySQL</a>
            
          </div>
        
        
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        
          
        

        
          <p>我们可以手动将日志文件中的数据刷到磁盘上，这一动作将触发MySQL服务器使用一个新的日志文件。过程如下：</p>
<ul>
<li>
<p>If general query logging or slow query logging to a log file is enabled, the server <code>closes and reopens</code> the general query log file or slow query log file.</p>
</li>
<li>
<p>If binary logging is enabled, the server closes the current binary log file and opens a new log file with the next sequence number.</p>
</li>
<li>
<p>If the server was started with the --log-error option to cause the error log to be written to a file, the server closes and reopens the log file.</p>
</li>
</ul>
<p>The server creates a new binary log file when you flush the logs. However, it just closes and reopens the general and slow query log files. To cause new files to be created on Unix, rename the current log files before flushing them. At flush time, the server opens new log files with the original names. For example, if the general and slow query log files are named mysql.log and mysql-slow.log, you can use a series of commands like this:</p>
          <div class="read-more">
            <a href="/2017/12/15/mysql-log-maintenance/" class="read-more-link">Read more..</a>
          </div>
        
      
    </div>

    

    

  </article>

    
  </section>

  
  <nav class="pagination">
    
      <a class="prev" href="/page/7/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text">Prev</span>
      </a>
    
    
      <a class="next" href="/page/9/">
        <span class="next-text">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>


          </div>
          

        </div>
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:acqua.young@gmail.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
        
          <a href="https://github.com/acquaai" class="iconfont icon-github" title="github"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    
    
    
      <a href="https://acquaai.github.io/atom.xml" class="iconfont icon-rss" title="rss"></a>
    
  </div>


<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">
    
    &copy; 
     
      2017 - 
    
    2019

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Acqua</span>
  </span>
</div>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    


    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  


    <script type="text/javascript" src="/js/src/even.js?v=2.6.0"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.6.0"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

  </body>
</html>
